<?xml version="1.0" encoding="UTF-8"?>
<web-app id="WebApp_ID" version="2.5"
    xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">

    
    <!--******************** Site Factory Core. Do not modify. ******************************************************-->
    <!--Integration of logback configuration, relying on the SSC config folder setup.-->
    <!--The parameter name is mandatory. Its value indicates a location relative to the configuration root folder, as -->
    <!--indicated by the prefix config: -->
    <context-param>
        <param-name>logbackConfigLocation</param-name>
        <param-value>config:logback.xml</param-value>
    </context-param>
    <context-param>
        <param-name>contextClass</param-name>
        <param-value>com.bnppf.ssc.imb.sf.fwk.commons.spring.resource.loader.ConfigRootAwareWebApplicationContext</param-value>
    </context-param>

    <!--This listener declaration acts as the logging starting point. Having it as the first listener in the application -->
    <!--allows for configuration of logging before anything else is started.-->
    <listener>
        <listener-class>com.bnppf.ssc.imb.sf.fwk.logging.config.web.LogbackConfigListener</listener-class>
    </listener>

    <!--Integration of Spring inside the web application, using the recommended way.-->
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <listener>
        <!-- needed for org.springframework.web.util.WebUtils.getSessionMutex to work correctly -->
        <listener-class>org.springframework.web.util.HttpSessionMutexListener</listener-class>
    </listener>

    <!-- ========================================== -->
    <!-- =====  START BNL EXTENSIONS       ======== -->
    <!-- ========================================== -->
    <!-- LOGGING FILTER -->
    

    <filter>
        <filter-name>bnlLoggingFilter</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>bnlLoggingFilter</filter-name>
        <url-pattern>/rpc/*</url-pattern>
    </filter-mapping>
    
    
    <!-- SSO MOCK TOGLIERE PER RILASCIO SU BNL  -->
    <filter>
        <filter-name>bnlSSOMockInjectionServletFilter</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>bnlSSOMockInjectionServletFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

   

    <filter>
        <filter-name>BnlSecurity</filter-name>
        <filter-class>it.bnl.sso.BNLSecureFilter</filter-class>
        <init-param>
            <param-name>BNLLoginPage</param-name>
            <param-value>${jfweb.login}</param-value>
        </init-param>
        <init-param>
            <param-name>BNLPriority</param-name>
            <param-value>5</param-value>
        </init-param>
        <init-param>
            <param-name>BNLResourceExtension</param-name>
            <param-value>jsp:do:html</param-value>
        </init-param>
        <init-param>
            <param-name>BNLSecureToken</param-name>
            <param-value>JFWebSecureToken</param-value>
        </init-param>
    </filter>

    <!-- DA RIMUOVERE SE SI VUOLE DISABILITARE IL SSO PER LO SVILUPPO BEGIN -->
    <filter-mapping>
        <filter-name>BnlSecurity</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <servlet>
        <servlet-name>SecureData</servlet-name>
        <servlet-class>it.bnl.sso.SecureData</servlet-class>
    </servlet>

    <servlet-mapping>
        <servlet-name>SecureData</servlet-name>
        <url-pattern>/getData</url-pattern>
    </servlet-mapping>
    
    <error-page>
        <error-code>412</error-code>
        <location>/error.jsp</location>
    </error-page>
    
    <!-- DA RIMUOVERE SE SI VUOLE DISABILITARE IL SSO PER LO SVILUPPO END -->
    
    <!-- ========================================== -->
    <!-- =====    END BNL EXTENSIONS       ======== -->
    <!-- ========================================== -->

    <!-- Needed to have RequestContextHolder filled in during filters execution -->
    <filter>
        <filter-name>RequestContextFilter</filter-name>
        <filter-class>org.springframework.web.filter.RequestContextFilter</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>RequestContextFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <filter>
        <filter-name>ControllerFiltersProxy</filter-name>
        <filter-class>com.bnppf.ssc.imb.sf.fwk.controller.filters.ControllerFiltersProxy</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>ControllerFiltersProxy</filter-name>
        <servlet-name>rpc</servlet-name>
    </filter-mapping>

    <!-- DA RIABILITIRARE SU AMBIENTI BNL-->
    <filter>
        <filter-name>GzipFilter</filter-name>
        <filter-class>net.sf.ehcache.constructs.web.filter.GzipFilter</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>GzipFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <!-- Example to disable browser caching on a resources -->
    <filter>
        <filter-name>NoCacheFilter</filter-name>
        <filter-class>com.bnppf.ssc.imb.sf.fwk.webutils.filters.NoCacheFilter</filter-class>
    </filter>
    <!-- No cache on home page. Also for unit-test reason -->
    <filter-mapping>
        <filter-name>NoCacheFilter</filter-name>
        <url-pattern>/wcm/app-index.html</url-pattern>
    </filter-mapping>
    <!-- No cache on servlet. Very useful for AJAX calls that some browsers caches extensively -->
    <filter-mapping>
        <filter-name>NoCacheFilter</filter-name>
        <servlet-name>rpc</servlet-name>
    </filter-mapping>

    <!--The JNDI resource that defines the SSC Root Config -->
    <resource-ref id="ResourceRef_1325698769428">
        <res-ref-name>SSC_ROOT_CONFIG</res-ref-name>
        <res-type>java.lang.String</res-type>
        <res-auth>Container</res-auth>
        <res-sharing-scope>Shareable</res-sharing-scope>
    </resource-ref>
    <!--*************************************************************************************************************-->


    <!--*************************************************************************************************************-->

    <!-- Spring MVC dispatcher servlet -->
    <servlet>
        <servlet-name>rpc</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextClass</param-name>
            <param-value>com.bnppf.ssc.imb.sf.fwk.commons.spring.resource.loader.ConfigRootAwareWebApplicationContext</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>rpc</servlet-name>
        <url-pattern>/rpc/*</url-pattern>
    </servlet-mapping>


    <welcome-file-list>
        <welcome-file>index.html</welcome-file>
    </welcome-file-list>

</web-app>